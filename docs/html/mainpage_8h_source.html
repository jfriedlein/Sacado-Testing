<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Trilinos::Sacado example: mainpage.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Trilinos::Sacado example
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mainpage.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mainpage_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">@{</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">\brief Example usage of Sacado for tensor calculus</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">\author jfriedlein</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">@tableofcontents</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">@mainpage Trilinos::Sacado example documentation</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">@section intro Introduction</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">The way we see and use Sacado here is as follows: \n</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">If you usually compute the following equation \n</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">\f[ c = a + b \f]</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">for instance with data types double as \n</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">\f[ 1.0 + 1.0 \rightarrow 2.0 \f]</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">your results is just a double number \f$ c \f$ that contains the value \f$ 2 \f$. \n</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">Using Sacado, on the other hand, the variable \f$ c_{fad} \f$ is now of, for example, data type</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">@code</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">    Sacado::Fad::DFad&lt;double&gt; c_fad;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">@endcode</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">As a result, \f$ c_{fad} \f$ now contains not just the number \f$ 2 \f$, but also all the derivatives of \f$ c_{fad} \f$</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">with respect to the previously defined degrees of freedom (set via command *.diff(*)). \n</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">The following figure tries to visualize this:</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\image html Sacado_data-type.png</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">@todo update this figure or add another one for second derivatives</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">@todo add another less general figure with c, a and b and explain what is meant by point p</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">If you right away want to use Sacado, then you might skip the first examples and jump to Ex3B.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">There we show how to use the &quot;Sacado_Wrapper&quot; that does everything from Ex2 and Ex3 in just a view lines of code. This does not mean that</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">the here shown approach is the fastest or most efficient, it is just simple and easy to use.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">Furthermore, if you, for instance, compute problems with two-fields (e.g. displacement and scalar damage) and you need</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">tangents with respect to both a tensor (e.g. strain tensor) and a scalar (e.g. damage variable), you can use the Sacado_Wrapper as shown in Ex4.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">Some more basics: \n</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">One can access the double value of \f$ c_{fad} \f$ with the Sacado command *.val():</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">@code</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">    double c_value = c_fad.val();</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">@endcode</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">The derivatives of \f$ c_{fad} \f$ can be accessed with the command *.dx():</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">@code</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">    double d_c_d_a = c_fad.dx(0);</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">    double c_c_d_b = c_fad.dx(1);</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">@endcode</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">The arguments of \a dx, namely 0 and 1 are the numbers corresponding to the dof that belong to \a a and \a b. More details on how to set this up</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">and use it, are given in example Ex1.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">Some resources/links: \n</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">You can use Sacado to compute general derivatives of functions (with or without tensors) with respect to variables (double, Tensors, ...).</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">@todo link the Sacado and DII pages</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">The here shown examples shall solely show how Sacado can be applied and give some background and a look under the hood.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">The code is neither elegant nor efficient, but it works. A more user-friendly version is provided by means of the &quot;Sacado_Wrapper&quot;. \n</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">@todo add list of files and an overview</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">@todo explain how to use the Wrapper (download the file Sacado_Wrapper.h, #include, ...)</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">@todo Check if factor 0.5 is also necessary for d_sigma / d_phi</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">@note This documentation and code only protocol my first steps with Sacado. They are not guaranteed to be correct neither are they verified.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">Any comments, criticism, corrections, feedback, improvements, ... are appreciated and very well welcomed.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">@section code The commented program</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\code</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> * Author: jfriedlein, 2019</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> *      dsoldner, 2019</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;\endcode</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;@section includes Include Files</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;The data type SymmetricTensor and some related operations, such as trace, symmetrize, deviator, ... <span class="keywordflow">for</span> tensor calculus</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;\code</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &lt;deal.II/base/symmetric_tensor.h&gt;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;\endcode</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;C++ headers (some basics, standard stuff)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;\code</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;\endcode</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;Sacado (from Trilinos, data types, operations, ...)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;\code</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &lt;Sacado.hpp&gt;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Sacado__Wrapper_8h.html">Sacado_Wrapper.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;\endcode</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;Those headers are related to data types and autodiff, but don<span class="stringliteral">&#39;t seem to be needed</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">//#  include &lt;deal.II/base/numbers.h&gt;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">//#  include &lt;deal.II/differentiation/ad/ad_number_traits.h&gt;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">//#  include &lt;deal.II/differentiation/ad/sacado_number_types.h&gt;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">According to the basics of deal.ii-programming (see dealii.org and https://www.dealii.org/current/doxygen/deal.II/step_1.html for a start)</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral">using namespace dealii;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">Defining a data type for the Sacado variables (here we simply used the standard types from the deal.ii step-33 tutorial&#39;</span>s introduction)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;\code</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">using</span> <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a> = Sacado::Fad::DFad&lt;double&gt;;   <span class="comment">// this data type now represents a double, but also contains the derivative of this variable with respect to the defined dofs (set via command *.diff(*))</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;\endcode</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;@section Ex1 1. example: simple scalar equation</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;1. example: simple scalar equation from deal.ii-tutorial step-33 (see the introduction there to <span class="keyword">get</span> a first impression, https:<span class="comment">//www.dealii.org/current/doxygen/deal.II/step_33.html)</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;@todo clean up the documentation of the classes</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;\code</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">void</span> <a class="code" href="Sacado__example_8cc.html#a71b2675e62203edc430e7ffc8a365193">sacado_test_scalar</a> ()</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Scalar Test:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;\endcode</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;define the variables used in the computation (inputs: a, b; output: <a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a>; auxiliaries: *) as the Sacado-data type</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;\code</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a> a,b,<a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;\endcode</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;initialize the input variables a and b; This (a,b) = (1,2) will be the point where the derivatives are computed.</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;Compare: y=x² -&gt; (dy/dx)(\@x=1) = 2. We can only compute the derivative numerically at a certain point.</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;\code</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     a = 1;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     b = 2;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    a.diff(0,2);  <span class="comment">// Set a to be dof 0, in a 2-dof system.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    b.diff(1,2);  <span class="comment">// Set b to be dof 1, in a 2-dof system.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;\endcode</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;Our equation here is very simply. But you can use nested equations and many standard mathematical operations, such as sqrt, pow, sin, ...</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;\code</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a> = 2*a + std::cos(a*b);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">double</span> *derivs = &amp;<a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a>.fastAccessDx(0); <span class="comment">// Access the derivatives of</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;\endcode</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;Output the derivatives of <a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a> with respect to the two above defined degrees of freedom (dof)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;\code</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Derivatives at the point (&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;dc/da = &quot;</span> &lt;&lt; derivs[0] &lt;&lt; <span class="stringliteral">&quot;, dc/db=&quot;</span> &lt;&lt; derivs[1] &lt;&lt; std::endl;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;\endcode</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;@section Ex2 2. example: Preparation <span class="keywordflow">for</span> the use of Sacado with tensors</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;Here we want to introduce tensors <span class="keywordflow">for</span> the first time. Hence, we limit ourselves to a trivial equation relating the strain tensor \a eps</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;with dim x dim components with the stress tensor \a sigma. Both here used tensors are symmetric, hence we use the SymmetricTensor <span class="keyword">class </span>and</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;have to keep some details in mind (see below factor 0.5 related to Voigt-Notation).</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;\code</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * 2. example: use of tensors</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;void <a class="code" href="Sacado__example_8cc.html#a8ef4ff1e9526ca8451cdcd1678366d2c">sacado_test_2</a> ()</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test 2:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;\endcode</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;First we <span class="keyword">set</span> the dimension \a dim: 2D-&gt;dim=2; 3D-&gt;dim=3 \n This defines the <span class="stringliteral">&quot;size&quot;</span> of the tensors and the number of dofs. Ex2 only works in 3D, whereas the following Ex3 is <span class="keyword">set</span> up dimension-independent.</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;\code</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = 3;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;\endcode</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;Declare our input, auxiliary and output variables as SymmetricTensors consisting of fad_doubles (instead of the standard SymmetricTensor out of doubles)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;\code</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    SymmetricTensor&lt;2,dim, fad_double&gt; sigma, eps;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;\endcode</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;Init the strain tensor (the point at which the derivative shall be computed)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;\code</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    eps[0][0] = 1;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    eps[1][1] = 2;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    eps[2][2] = 3;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    eps[0][1] = 4;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    eps[0][2] = 5;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    eps[1][2] = 6;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;\endcode</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;Now we declare the dofs. The derivative to a tensor requires all components, therefore we <span class="keyword">set</span> the components of the strain tensor here one by one as the dofs.</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;Because our tensors are symmetric, we only need 6 components in 3D instead of 9 <span class="keywordflow">for</span> a full second order tensor</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;\code</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    eps[0][0].diff(0,6);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    eps[1][1].diff(1,6);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    eps[2][2].diff(2,6);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    eps[0][1].diff(3,6);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    eps[0][2].diff(4,6);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    eps[1][2].diff(5,6);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;\endcode</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;The equation describing the stresses (here just a simple test <span class="keywordflow">case</span>)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;\code</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    sigma = eps;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;\endcode</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;Let<span class="stringliteral">&#39;s output the computed stress tensor.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="stringliteral">    std::cout &lt;&lt; sigma &lt;&lt; std::endl;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="stringliteral">The resulting values of \a sigma are fairly boring, due to our simple equation. It is the additional output generated by</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="stringliteral">this, that is interesting here: \n</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="stringliteral">output: \n</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="stringliteral">1 [ 1 0 0 0 0 0 ] 4 [ 0 0 0 1 0 0 ] 5 [ 0 0 0 0 1 0 ] 4 [ 0 0 0 1 0 0 ] 2 [ 0 1 0 0 0 0 ] 6 [ 0 0 0 0 0 1 ] 5 [ 0 0 0 0 1 0 ] 6 [ 0 0 0 0 0 1 ] 3 [ 0 0 1 0 0 0 ] \n</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="stringliteral">The numbers 1, 4, 5, 4, ... are the entries in the stress tensor \a sigma. In square brackets we see the derivatives of sigma with respect to all the dofs set previously</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="stringliteral">given in the order we defined them above. Meaning: The first entry in the square brackets corresponds to the 0-th dof set by</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="stringliteral">@code eps[0][0].diff(0,6); @endcode referring to the component (0,0) in the strain tensor \a eps.</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="stringliteral">Computing the derivatives for certain components of the resulting tangent modulus: \n</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral">We now access these lists of derivatives (output above in square brackets) for one component of the stress tensor \a sigma at a time.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="stringliteral">    {</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral">Access the derivatives corresponding to the component (0,0) of the stress tensor \a sigma</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="stringliteral">        double *derivs = &amp;sigma[0][0].fastAccessDx(0);</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="stringliteral">The following output will show us the same derivatives that we already saw above, just formatted differently \n</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="stringliteral">output: d_sigma[0][0]/d_eps = 1 , 0 , 0 , 0 , 0 , 0 ,</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral">        std::cout &lt;&lt; &quot;d_sigma[0][0]/d_eps = &quot;;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">        for ( unsigned int i=0; i&lt;6; ++i)</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">            std::cout &lt;&lt; derivs[i] &lt;&lt; &quot; , &quot;;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="stringliteral">        std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="stringliteral">    }</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="stringliteral">    {</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="stringliteral">Access the derivatives corresponding to the component (1,2) of the stress tensor \a sigma</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="stringliteral">        double *derivs = &amp;sigma[1][2].fastAccessDx(0);</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="stringliteral">output: d_sigma[1][2]/d_eps = 0 , 0 , 0 , 0 , 0 , 1 ,</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="stringliteral">        std::cout &lt;&lt; &quot;d_sigma[1][2]/d_eps = &quot;;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="stringliteral">        for ( unsigned int i=0; i&lt;6; ++i)</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="stringliteral">            std::cout &lt;&lt; derivs[i] &lt;&lt; &quot; , &quot;;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral">        std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">    }</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="stringliteral">@section Ex3 3. example: Using a slightly more complicated stress equation</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="stringliteral">void sacado_test_3 ()</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="stringliteral">    std::cout &lt;&lt; &quot;Test 3:&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="stringliteral">    const unsigned int dim = 3;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="stringliteral">Here we also define some constant, for instance the bulk modulus \a kappa and the second Lamè parameter \a mu.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="stringliteral">We now also define one of our constants as fad_double. By doing this we can use the normal multiplication (see below).</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="stringliteral">    double kappa_param = 5;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="stringliteral">    fad_double kappa (kappa_param);</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="stringliteral">The second constant remains as a double just to show the difference.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral">    double mu = 2;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="stringliteral">    SymmetricTensor&lt;2,dim, fad_double&gt; sigma, eps;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="stringliteral">To simplify the access to the dofs we define a map that relate the components of our strain tensor to the dof-nbr</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="stringliteral">    std::map&lt;unsigned int,std::pair&lt;unsigned int,unsigned int&gt;&gt; std_map_indicies;</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">The point at which the derivative shall be computed: \n</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral">As mentioned previously, we will implement this example for 2D and 3D, hence we once have to set up a strain tensor</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">and the derivatives for 3D with 6 independent components ...</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="stringliteral">    if(dim==3)</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="stringliteral">    {</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="stringliteral">        eps[0][0] = 1;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="stringliteral">        eps[1][1] = 2;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="stringliteral">        eps[2][2] = 3;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="stringliteral">        eps[0][1] = 4;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="stringliteral">        eps[0][2] = 5;</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="stringliteral">        eps[1][2] = 6;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="stringliteral">        eps[0][0].diff(0,6);</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="stringliteral">        eps[0][1].diff(1,6);</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">        eps[0][2].diff(2,6);</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">        eps[1][1].diff(3,6);</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">        eps[1][2].diff(4,6);</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral">        eps[2][2].diff(5,6);</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="stringliteral">By using the map and the following pairs, we have to set up the relation between strain components and dofs only once</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="stringliteral">and can use the map to access the entries of the list later, without possibly mixing up indices and creating errors.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="stringliteral">Please don&#39;</span>t be confused, but the dofs in the Wrapper are <span class="keyword">set</span> up</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;in a different order that we showed earlier. Earlier: (0,0)-(1,1)-(2,2)-...; Now: (0,0)-(0,1)-(0,2)-...</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;\code</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        std::pair&lt;unsigned int, unsigned int&gt; tmp_pair;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        tmp_pair.first=0; tmp_pair.second=0;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        std_map_indicies[0] = tmp_pair;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        tmp_pair.first=0; tmp_pair.second=1;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        std_map_indicies[1] = tmp_pair;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        tmp_pair.first=0; tmp_pair.second=2;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        std_map_indicies[2] = tmp_pair;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        tmp_pair.first=1; tmp_pair.second=1;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        std_map_indicies[3] = tmp_pair;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        tmp_pair.first=1; tmp_pair.second=2;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        std_map_indicies[4] = tmp_pair;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        tmp_pair.first=2; tmp_pair.second=2;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        std_map_indicies[5] = tmp_pair;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;\endcode</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;... and once <span class="keywordflow">for</span> 2D with just 3 independent components.</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;\code</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dim==2)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        eps[0][0] = 1;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        eps[1][1] = 2;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        eps[0][1] = 4;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        eps[0][0].diff(0,3);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        eps[0][1].diff(1,3);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        eps[1][1].diff(2,3);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        std::pair&lt;unsigned int, unsigned int&gt; tmp_pair;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        tmp_pair.first=0; tmp_pair.second=0;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        std_map_indicies[0] = tmp_pair;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        tmp_pair.first=0; tmp_pair.second=1;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        std_map_indicies[1] = tmp_pair;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        tmp_pair.first=1; tmp_pair.second=1;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        std_map_indicies[2] = tmp_pair;        </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;only dim==2 or dim==3 allowed&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;\endcode</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;Instead of calling the *.diff(*) on the components one-by-one we could also use the following <span class="keywordflow">for</span>-loop, so</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;we also use the map to <span class="keyword">set</span> the dofs (as we will <span class="keywordflow">do</span> in the Wrapper later).</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;@code</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x=0; x&lt;((dim==2)?3:6); ++x )</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=std_map_indicies[x].first;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=std_map_indicies[x].second;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    eps[i][j].diff(x,((dim==2)?3:6));</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;For our slightly more complicated stress equation we need the unit and deviatoric tensors.</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;We can simply define them by writing the values of the already existing deal.ii functions into newly</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;defined SymmetricTensors build from fad_doubles.</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;\code</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    SymmetricTensor&lt;2,dim, fad_double&gt; stdTensor_I (( unit_symmetric_tensor&lt;dim,fad_double&gt;()) );</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    SymmetricTensor&lt;4,dim, fad_double&gt; stdTensor_Idev ( (deviator_tensor&lt;dim,fad_double&gt;()) );</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;\endcode</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;With everything <span class="keyword">set</span> and defined, we can compute our stress \a sigma according to:</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;\f[ \sigma = \kappa \cdot trace(\varepsilon) \cdot \boldsymbol{I} + 2 \cdot \mu \cdot \varepsilon^{dev} \f]</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;Here you can see that we can directly multiply the constant and the tensors when kappa is also declared as fad_double</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;\code</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    sigma = kappa * (trace(eps) *  stdTensor_I);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;\endcode</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;We didn<span class="stringliteral">&#39;t do the same for mu to once again emphasize the difference between constants as double and as fad_double. \n</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="stringliteral">The remaining code uses a normal double constant.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral">    SymmetricTensor&lt;2,dim,fad_double&gt; tmp = deviator&lt;dim,fad_double&gt;(symmetrize&lt;dim,fad_double&gt;(eps)); tmp*=(mu*2);</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="stringliteral">    sigma +=  tmp;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="stringliteral">The fairly cumbersome computation is caused by the way the operators are set up for tensors out of fad_doubles.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="stringliteral">    std::cout &lt;&lt; &quot;sigma=&quot; &lt;&lt; sigma &lt;&lt; std::endl;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="stringliteral">Now we want to actually build our tangent modulus called \a C_Sacado that contains all the derivatives and relates</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">the stress tensor with the strain tensor. \n</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">The fourth-order tensor \a C_Sacado is our final goal, we don&#39;</span>t have to compute anything that is related to Sacado with</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keyword">this</span> tensor, so we can <span class="keywordflow">finally</span> <span class="keywordflow">return</span> to our standard SymmetricTensor out of doubles. The latter is necessary to use</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;the tangent in the actual FE code.</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;\code</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    SymmetricTensor&lt;4,dim&gt; C_Sacado;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;\endcode</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;As in Ex2 we access the components of the stress tensor one by one. In order to capture all of them we sum over the</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;components i and j of the stress tensor.</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;\code</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dim; ++i)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dim; ++j )</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordtype">double</span> *derivs = &amp;sigma[i][j].fastAccessDx(0); <span class="comment">// Access the derivatives of the (i,j)-th component of \a sigma</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;\endcode</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;To visually ensure that every stress component has in fact all 6 derivatives <span class="keywordflow">for</span> 3D or 3 <span class="keywordflow">for</span> 2D, we output the size:</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;\code</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;size: &quot;</span>&lt;&lt;sigma[i][j].size()&lt;&lt;std::endl;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;\endcode</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;We loop over all the dofs. To be able to use <span class="keyword">this</span> independent of the chosen dimension \a dim, we use a ternary <span class="keyword">operator</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;to decide whether we have to loop over 6 derivatives or just 3.</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;\code</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x=0;x&lt;((dim==2)?3:6);++x)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=std_map_indicies[x].first;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l=std_map_indicies[x].second;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">if</span>(k!=l)<span class="comment">/*Compare to Voigt notation since only SymmetricTensor instead of Tensor*/</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    C_Sacado[i][j][k][l] = 0.5*derivs[x];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    C_Sacado[i][j][l][k] = 0.5*derivs[x];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    C_Sacado[i][j][k][l] = derivs[x];</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            }            </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;\endcode</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;After resembling the fourth-order tensor, we now have got our tangent saved in \a C_Sacado ready to be used</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;To ensure that Sacado works properly, we can compute the analytical tangent <span class="keywordflow">for</span> comparison</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;\code</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">double</span> kappa_d = 5;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">double</span> mu_d = 2;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;\endcode</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;Our stress equation in <span class="keyword">this</span> example is still simple enough to derive the tangent analytically by hand:</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;\f[ \overset{4}{C_{analy}} = \kappa \cdot \boldsymbol{I} \otimes \boldsymbol{I} + 2 \cdot \mu \cdot \overset{4}{I^{dev}} \f]</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;\code</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    SymmetricTensor&lt;4,dim&gt; C_analy = kappa_d * outer_product(unit_symmetric_tensor&lt;dim&gt;(), unit_symmetric_tensor&lt;dim&gt;()) + 2* mu_d * deviator_tensor&lt;dim&gt;();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;\endcode</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;We again define our strain tensor \a eps_d (*_d <span class="keywordflow">for</span> standard <span class="keywordtype">double</span> in contrast to <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a>)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;\code</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    SymmetricTensor&lt;2,dim&gt; eps_d;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span>(dim==3)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        eps_d[0][0] = 1;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        eps_d[1][1] = 2;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        eps_d[2][2] = 3;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        eps_d[0][1] = 4;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        eps_d[0][2] = 5;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        eps_d[2][1] = 6;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dim==2)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        eps_d[0][0] = 1;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        eps_d[1][1] = 2;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        eps_d[1][0] = 4;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;only dim==2 or dim==3 allowed&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;\endcode</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;@todo use boldsymbol <span class="keywordflow">for</span> tensors</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;To output the stress tensor we first have to compute it. We <span class="keywordflow">do</span> <span class="keyword">this</span> here via</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;\f[ \sigma = \overset{4}{C_{analy}} : \varepsilon \f]</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;The output exactly matched the result obtained with Sacado.</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;@note Checking the Sacado stress tensor against an analytically computed or otherwise determined stress tensor is absolutely no way to check whether</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;the tangent computed via Sacado is correct. When we compute the stress tensor with Sacado and <span class="keywordflow">for</span> example mix up a + and - sign, <span class="keyword">this</span> might not matter</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;at all <span class="keywordflow">if</span> the number that is added or subtracted is small. However, <span class="keywordflow">for</span> the tangent <span class="keyword">this</span> nasty sign can be very critical. Just keep in mind: the</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;tangent has 81 components and the stress tensor just 9, so how does one want to verify 81 variables by comparing 9?</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;\code</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;sigma_analy: &quot;</span> &lt;&lt; (C_analy*eps_d) &lt;&lt; std::endl;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;\endcode</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;That<span class="stringliteral">&#39;s the reason we compare all the entries in the Sacado and the analytical tensor one by one</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="stringliteral">    for (unsigned int i=0; i&lt;dim; ++i)</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">        for ( unsigned int j=0; j&lt;dim; ++j)</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral">            for ( unsigned int k=0; k&lt;dim; ++k)</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">                for ( unsigned int l=0; l&lt;dim; ++l)</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">                    std::cout &lt;&lt; &quot;C_analy[&quot;&lt;&lt;i&lt;&lt;&quot;][&quot;&lt;&lt;j&lt;&lt;&quot;][&quot;&lt;&lt;k&lt;&lt;&quot;][&quot;&lt;&lt;l&lt;&lt;&quot;] = &quot; &lt;&lt; C_analy[i][j][k][l] &lt;&lt; &quot; vs C_Sacado: &quot; &lt;&lt; C_Sacado[i][j][k][l] &lt;&lt; std::endl;</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="stringliteral">To simplify the comparison we compute a scalar error as the sum of the absolute differences of each component</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral">    double error_Sacado_vs_analy=0;</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="stringliteral">    for (unsigned int i=0; i&lt;dim; ++i)</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral">        for ( unsigned int j=0; j&lt;dim; ++j)</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral">            for ( unsigned int k=0; k&lt;dim; ++k)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="stringliteral">                for ( unsigned int l=0; l&lt;dim; ++l)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">                    error_Sacado_vs_analy += std::fabs(C_Sacado[i][j][k][l] - C_analy[i][j][k][l]);</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">As desired: The numerical error is zero (0 in double precision) and the tensor components are equal</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral">    std::cout &lt;&lt; &quot;numerical error: &quot; &lt;&lt; error_Sacado_vs_analy &lt;&lt; std::endl;</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">@section Ex3B 3B. Example: Using the wrapper for Ex3</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral">void sacado_test_3B ()</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="stringliteral">    std::cout &lt;&lt; &quot;Test 3B:&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="stringliteral">    const unsigned int dim=3;</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="stringliteral">The following declarations are usually input arguments. So you receive the strain tensor and the constants out of doubles.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="stringliteral">    SymmetricTensor&lt;2,dim&gt; eps_d;</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="stringliteral">    eps_d[0][0] = 1;</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="stringliteral">    eps_d[1][1] = 2;</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="stringliteral">    eps_d[2][2] = 3;</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="stringliteral">    eps_d[0][1] = 4;</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="stringliteral">    eps_d[0][2] = 5;</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="stringliteral">    eps_d[1][2] = 6;</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="stringliteral">    double kappa = 5;</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="stringliteral">    double mu = 2;</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="stringliteral">Now we start working with Sacado: \n</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="stringliteral">When we use the index notation to compute e.g. our stress we do not need to declare our constants (here kappa, mu) as</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="stringliteral">fad_double.</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="stringliteral">We declare our strain tensor as the special data type Sacado_Wrapper::SymTensor from the file &quot;Sacado_Wrapper.h&quot;</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="stringliteral">where this data type was derived from the SymmetricTensor&lt;2,dim,fad_double&gt;.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="stringliteral">     Sacado_Wrapper::SymTensor&lt;dim&gt; eps;</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="stringliteral">Next we initialize our Sacado strain tensor with the values of the inputed double strain tensor:</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="stringliteral">     eps.init(eps_d);</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="stringliteral">We define all the entries in the symmetric tensor \a eps as the dofs. So we can later derive any variable</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="stringliteral">with respect to the strain tensor \a eps.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="stringliteral">     eps.set_dofs();</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="stringliteral">Now we declare our output and auxiliary variables as Sacado-Tensors.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">     SymmetricTensor&lt;2,dim,fad_double&gt; sigma;</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">     SymmetricTensor&lt;2,dim, fad_double&gt; stdTensor_I (( unit_symmetric_tensor&lt;dim,fad_double&gt;()) );</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">Our stress equation is now computed in index notation to simplify the use of the constants and</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">especially the use of the \a deviator.</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">      for ( unsigned int i=0; i&lt;dim; ++i)</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">        for ( unsigned int j=0; j&lt;dim; ++j )</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">            sigma[i][j] = kappa * trace(eps) *  stdTensor_I[i][j] + 2. * mu * deviator(eps)[i][j];</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">Finally we declare our desired tangent as the fourth order tensor \a C_Sacado and compute the tangent via</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">the command \a get_tangent.</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">     SymmetricTensor&lt;4,dim&gt; C_Sacado;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">     eps.get_tangent(C_Sacado, sigma);</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="stringliteral">We could again compare the herein computed tangent with the analytical tangent from Ex2, but as before</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral">the results are fairly boring, because Sacado hits the analytical tangent exactly --- no surprise for such</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="stringliteral">simple equations.</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral">And that&#39;</span>s it. By <span class="keyword">using</span> the Sacado_wrapper we can achieve everything from Ex2 (besides the equations)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;with just four lines of code namely:</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;- eps.init(eps_d);    <span class="comment">// To initialize the Sacado strain tensor</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;- eps.set_dofs();     <span class="comment">// To declare the components of eps as the dofs</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;- eps.get_tangent(*); <span class="comment">// To get the tangent</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;\code</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;\endcode</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;@section Ex4 4. Example: Computing derivatives with respect to a tensor and a scalar</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;\code</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordtype">void</span> <a class="code" href="Sacado__example_8cc.html#a2f4def4563e31d720e07bc7d6363ebe2">sacado_test_4</a> ()</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test 4:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim=3;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;\endcode</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;The following declarations are usually input arguments. So you receive the strain tensor \q eps_d,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;the damage variable \a phi and the constants \a kappa and \a mu out of doubles.</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;\code</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    SymmetricTensor&lt;2,dim&gt; eps_d;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    eps_d[0][0] = 1;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    eps_d[1][1] = 2;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    eps_d[2][2] = 3;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    eps_d[0][1] = 4;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    eps_d[0][2] = 5;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    eps_d[1][2] = 6;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">double</span> phi_d = 0.3;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;\endcode</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;We don<span class="stringliteral">&#39;t need these constants in the current example.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="stringliteral">double kappa = 5;</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="stringliteral">double mu = 2;</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="stringliteral">We set up our strain tensor as in Ex3B.</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">     Sacado_Wrapper::SymTensor&lt;dim&gt; eps;</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">     Sacado_Wrapper::SW_double&lt;dim&gt; phi;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">Initialize the strain tensor and the damage variable</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="stringliteral">     eps.init(eps_d);</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">     phi.init(phi_d);</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral">Set the dofs, where the argument sets the total nbr of dofs (3 or 6 for the sym. tensor and 1 for the double)</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">//    eps.set_dofs(eps.n_independent_components+1/*an additional dof for phi*/);</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">In order to also compute derivatives with respect to the scalar \a phi, we add this scalar to our list</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="stringliteral">of derivatives. Because we have already defined 3 or 6 dofs our additional dof will be placed at the end</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="stringliteral">of this list. We set this up with the member variable start_index ...</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral">//    phi.start_index=eps.n_independent_components;</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral">and again using the input argument representing the total number of dofs</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="stringliteral">//    phi.set_dofs(eps.n_independent_components+1);</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">All of the above 3 lines of code are automatically done by the DoFs_summary class. So, to</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">set our dofs we just create an instance and call set_dofs with our variables containing the desired dofs.</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="stringliteral">     Sacado_Wrapper::DoFs_summary&lt;dim&gt; DoFs_summary;</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="stringliteral">     DoFs_summary.set_dofs(eps, phi);</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">Compute the stress tensor and damage variable \a d (here we just use some arbitrary equations for testing): \n</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">Let us first declare our output (and auxiliary) variables as Sacado data types.</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral">      SymmetricTensor&lt;2,dim,fad_double&gt; sigma;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral">      fad_double d;</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral">@todo It would be nice to use the data types from the Sacado_Wrapper for all the Sacado variables. But</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">somehow the operators (multiply*, ...) seem to cause conflicts again.</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral">The actual computation in the following scope uses the exact same equation as your normal computation e. g. via the data type double.</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral">Hence, you could either directly compute your stress, etc. via the Sacado variables or you define</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">template functions that contain your equations and are either called templated with double or fad_double.</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">When using the first option, please consider the computation time that is generally higher for a computation</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">with fad_double than with normal doubles (own experience in a special case: slower by factor 30).</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">The second option with templates does not suffer these issues.</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">      {</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">      for ( unsigned int i=0; i&lt;dim; ++i)</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">        for ( unsigned int j=0; j&lt;dim; ++j )</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral">            sigma[i][j] = phi * eps[i][j];</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">ToDo: strangely when phi is a fad_double then the multiplication phi * eps works directly without</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">having to use the index notation</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;sigma=&quot; &lt;&lt; sigma &lt;&lt; std::endl;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">      d = phi*phi + 25 + trace(eps);</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;d=&quot; &lt;&lt; d &lt;&lt; std::endl;</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="stringliteral">Get the tangents</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="stringliteral">d_sigma / d_eps: SymmetricTensor with respect to SymmetricTensor</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="stringliteral">      SymmetricTensor&lt;4,dim&gt; C_Sacado;</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="stringliteral">      eps.get_tangent(C_Sacado, sigma);</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;C_Sacado=&quot; &lt;&lt; C_Sacado &lt;&lt; std::endl;</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">Compute the analytical tangent:</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral">      SymmetricTensor&lt;4,dim&gt; C_analy;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">      C_analy = phi_d * identity_tensor&lt;dim&gt;();</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;C_analy =&quot; &lt;&lt; C_analy &lt;&lt; std::endl;</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">d_d / d_eps: double with respect to SymmetricTensor</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">      SymmetricTensor&lt;2,dim&gt; d_d_d_eps;</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">      eps.get_tangent(d_d_d_eps, d);</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;d_d_d_eps=&quot; &lt;&lt; d_d_d_eps &lt;&lt; std::endl;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral">d_sigma / d_phi: SymmetricTensor with respect to double</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">      SymmetricTensor&lt;2,dim&gt; d_sigma_d_phi;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral">      phi.get_tangent(d_sigma_d_phi, sigma);</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;d_sigma_d_phi=&quot; &lt;&lt; d_sigma_d_phi &lt;&lt; std::endl;</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;sigma = d_sigma_d_phi * phi = &quot; &lt;&lt; d_sigma_d_phi * phi_d &lt;&lt; std::endl;</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">d_d / d_phi: double with respect to double</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">\code</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral">      double d_d_d_phi;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral">      phi.get_tangent(d_d_d_phi, d);</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral">      std::cout &lt;&lt; &quot;d_d_d_phi=&quot; &lt;&lt; d_d_d_phi &lt;&lt; std::endl;</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="stringliteral">\endcode</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="stringliteral">And that&#39;</span>s it. By <span class="keyword">using</span> the Sacado_wrapper we can compute derivatives with respect to</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;a tensor and a scalar at the same time (besides the equations)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;in essence with just the following lines of code namely:</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;- eps.init(eps_d); phi.init(phi_d);   <span class="comment">// To initialize the Sacado strain tensor and scalar damage variable</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;- DoFs_summary.set_dofs(eps, phi);    <span class="comment">// To declare the components of eps and phi as the dofs</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;- eps.get_tangent(*); <span class="comment">// To get tangents with respect to eps</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;- phi.get_tangent(*); <span class="comment">// To get tangents with respect to phi</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;\code</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;\endcode</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;@section Ex5 5. Example: Using a vector-valued equation</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;\code</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordtype">void</span> <a class="code" href="Sacado__example_8cc.html#a327dbbb4ea7fc9840c46d149843a44c2">sacado_test_5</a> ()</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;{</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim=3;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test 5:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    Tensor&lt;1,dim,fad_double&gt; <a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a> a,b;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs=2;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    a = 1; b = 2;   <span class="comment">// at the point (a,b) = (1,2)</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    a.diff(0,2);  <span class="comment">// Set a to be dof 0, in a 2-dof system.</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    b.diff(1,2);  <span class="comment">// Set b to be dof 1, in a 2-dof system.</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;\endcode</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;c is now a vector with three components</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;\code</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    c[0] = 2*a+3*b;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    c[1] = 4*a+5*b;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    c[2] = 6*a+7*b;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;\endcode</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;Access to the derivatives works as before.</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;\code</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;dim;++i)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keyword">const</span> <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a> &amp;derivs = c[i]; <span class="comment">// Access derivatives</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0;j&lt;n_dofs;++j)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Derivatives at the point (&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot;) for &quot;</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            &lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;th component wrt &quot;</span>&lt;&lt;j&lt;&lt;<span class="stringliteral">&quot;th direction &quot;</span>&lt;&lt; std::endl;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;dc_i/dxj = &quot;</span> &lt;&lt; derivs.fastAccessDx(j) &lt;&lt; std::endl;            </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;\endcode</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;@section Ex6 6. Example: First and second derivatives - Scalar equation</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;The here shown example was copied from https:<span class="comment">//github.com/trilinos/Trilinos/blob/master/packages/sacado/example/dfad_dfad_example.cpp</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;and modified to <span class="keyword">get</span> a first impression on how we can work with first and second derivatives</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;\code</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keywordtype">void</span> <a class="code" href="Sacado__example_8cc.html#a27450ab52a9d4250e3f5a5f2a3f8f317">sacado_test_6</a> ()</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;{</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test 6:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;\endcode</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;Define the variables used in the computation (inputs: a, b; output: <a class="code" href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a>; auxiliaries: *) as doubles</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;\code</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;     <span class="keywordtype">double</span> a=1;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;     <span class="keywordtype">double</span> b=2;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;\endcode</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;Number of independent variables (scalar a and b)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;\code</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;     <span class="keywordtype">int</span> num_dofs = 2;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;\endcode</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;Define another data type containing even more Sacado data types</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;@todo <span class="keywordflow">try</span> to merge the <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a> data type with <span class="keyword">this</span> templated data type</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;\code</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;     <span class="keyword">typedef</span> Sacado::Fad::DFad&lt;double&gt; <a class="code" href="Sacado__Wrapper_8h.html#a7e0893207b87dad05c66a34baac8ed2e">DFadType</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;     Sacado::Fad::DFad&lt;DFadType&gt; afad(num_dofs, 0, a);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;     Sacado::Fad::DFad&lt;DFadType&gt; bfad(num_dofs, 1, b);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;     Sacado::Fad::DFad&lt;DFadType&gt; cfad;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;\endcode</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;Output the variables: We se that the values of \a a and \a b are <span class="keyword">set</span> but the derivatives have not yet been fully declared</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;\code</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;afad=&quot;</span> &lt;&lt; afad &lt;&lt; std::endl;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;bfad=&quot;</span> &lt;&lt; bfad &lt;&lt; std::endl;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;cfad=&quot;</span> &lt;&lt; cfad &lt;&lt; std::endl;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;\endcode</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;Now we <span class="keyword">set</span> the <span class="stringliteral">&quot;inner&quot;</span> derivatives.</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;\code</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    afad.val() = <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a>(num_dofs, 0, a); <span class="comment">// set afad.val() as the first dof and init it with the double a</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    bfad.val() = <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a>(num_dofs, 1, b);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;\endcode</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;Compute <span class="keyword">function</span> and derivative with AD</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;\code</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;     cfad = 2*afad + std::cos(afad*bfad);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;\endcode</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;After <span class="keyword">this</span>, we output the variables again and see that some additional derivatives have been declared. Furthermore,</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;\a cfad is filled with the values and derivatives</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;\code</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;afad=&quot;</span> &lt;&lt; afad &lt;&lt; std::endl;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;bfad=&quot;</span> &lt;&lt; bfad &lt;&lt; std::endl;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;cfad=&quot;</span> &lt;&lt; cfad &lt;&lt; std::endl;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;\endcode</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;Extract value and derivatives</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;\code</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;     <span class="keywordtype">double</span> c_ad = cfad.val().val();       <span class="comment">// r</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;     <span class="keywordtype">double</span> dcda_ad = cfad.dx(0).val();    <span class="comment">// dr/da</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;     <span class="keywordtype">double</span> dcdb_ad = cfad.dx(1).val();    <span class="comment">// dr/db</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;     <span class="keywordtype">double</span> d2cda2_ad = cfad.dx(0).dx(0);  <span class="comment">// d^2r/da^2</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;     <span class="keywordtype">double</span> d2cdadb_ad = cfad.dx(0).dx(1); <span class="comment">// d^2r/dadb</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;     <span class="keywordtype">double</span> d2cdbda_ad = cfad.dx(1).dx(0); <span class="comment">// d^2r/dbda</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;     <span class="keywordtype">double</span> d2cdb2_ad = cfad.dx(1).dx(1);  <span class="comment">// d^2/db^2</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;\endcode</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;Now we can print the actual <span class="keywordtype">double</span> value of c and some of the derivatives:</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;\code</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;c_ad=&quot;</span> &lt;&lt; c_ad &lt;&lt; std::endl;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Derivatives at the point (&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;dc/da = &quot;</span> &lt;&lt; dcda_ad &lt;&lt; <span class="stringliteral">&quot;, dc/db=&quot;</span> &lt;&lt; dcdb_ad &lt;&lt; std::endl;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d²c/da² = &quot;</span> &lt;&lt; d2cda2_ad &lt;&lt; <span class="stringliteral">&quot;, d²c/db²=&quot;</span> &lt;&lt; d2cdb2_ad &lt;&lt; std::endl;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d²c/dadb = &quot;</span> &lt;&lt; d2cdadb_ad &lt;&lt; <span class="stringliteral">&quot;, d²c/dbda=&quot;</span> &lt;&lt; d2cdbda_ad &lt;&lt; std::endl;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;}</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;\endcode</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;@section Ex7 7. Example: First and second derivatives - Using tensor (The full story)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;\code</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="keywordtype">void</span> <a class="code" href="Sacado__example_8cc.html#a0b694459e5e15c1578d97e637faba8de">sacado_test_7</a> ()</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;{</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim=3;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test 7:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;\endcode</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;Defining the inputs (material parameters, strain tensor)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;\code</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;     <span class="keywordtype">double</span> lambda=1;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;     <span class="keywordtype">double</span> mu=2;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;     SymmetricTensor&lt;2,dim, double&gt; eps;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;     eps[0][0] = 1.;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;     eps[1][1] = 2.;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;     eps[2][2] = 3.;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;     eps[0][1] = 4.;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;     eps[0][2] = 5.;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;     eps[1][2] = 6.;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;\endcode</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;Here we skip the one-field example and right away show the equations <span class="keywordflow">for</span> a two-field problem</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;with \a eps and \a phi.</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;\code</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;     <span class="keywordtype">double</span> phi=0.3;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;\endcode</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;Setup of the map relating the indices (as before)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;\code</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;     std::map&lt;unsigned int,std::pair&lt;unsigned int,unsigned int&gt;&gt; std_map_indicies;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;     std::pair&lt;unsigned int, unsigned int&gt; tmp_pair;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;     tmp_pair.first=0; tmp_pair.second=0;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;     std_map_indicies[0] = tmp_pair;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;     tmp_pair.first=0; tmp_pair.second=1;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;     std_map_indicies[1] = tmp_pair;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;     tmp_pair.first=0; tmp_pair.second=2;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;     std_map_indicies[2] = tmp_pair;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;     tmp_pair.first=1; tmp_pair.second=1;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;     std_map_indicies[3] = tmp_pair;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;     tmp_pair.first=1; tmp_pair.second=2;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;     std_map_indicies[4] = tmp_pair;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;     tmp_pair.first=2; tmp_pair.second=2;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;     std_map_indicies[5] = tmp_pair;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;\endcode</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;Number of independent variables (6 <span class="keywordflow">for</span> the tensor and 1 <span class="keywordflow">for</span> the scalar phi)</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;\code</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nbr_dofs = 6+1;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;\endcode</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;Declaring the special data types containing all derivatives</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;\code</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;     <span class="keyword">typedef</span> Sacado::Fad::DFad&lt;double&gt; <a class="code" href="Sacado__Wrapper_8h.html#a7e0893207b87dad05c66a34baac8ed2e">DFadType</a>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;     SymmetricTensor&lt;2,dim, Sacado::Fad::DFad&lt;DFadType&gt; &gt; eps_fad, eps_fad_squared;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;     Sacado::Fad::DFad&lt;DFadType&gt; phi_fad;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;\endcode</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;Setting the dofs</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;\code</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x=0; x&lt;6; ++x )</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;     {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=std_map_indicies[x].first;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=std_map_indicies[x].second;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        (eps_fad[i][j]).diff( x, nbr_dofs); <span class="comment">// set up the &quot;inner&quot; derivatives</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        (eps_fad[i][j]).val() = <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a>(nbr_dofs, x, eps[i][j]); <span class="comment">// set up the &quot;outer&quot; derivatives</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;     }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;     phi_fad.diff( 6, nbr_dofs );</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;     phi_fad.val() = <a class="code" href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a>(nbr_dofs, 6, phi); <span class="comment">// set up the &quot;outer&quot; derivatives</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;eps_fad=&quot;</span> &lt;&lt; eps_fad &lt;&lt; std::endl;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;phi_fad=&quot;</span> &lt;&lt; phi_fad &lt;&lt; std::endl;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;\endcode</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;Compute eps² = eps_ij * eps_jk in index notation</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;\code</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dim; ++i)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;dim; ++k )</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dim; ++j )</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                <span class="keywordflow">if</span> ( i&gt;=k )</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    eps_fad_squared[i][k] += eps_fad[i][j] * eps_fad[j][k];</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;\endcode</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;Compute the strain energy density</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;\code</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;     Sacado::Fad::DFad&lt;DFadType&gt; energy;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;     energy = lambda/2. * trace(eps_fad)*trace(eps_fad) + mu * trace(eps_fad_squared) + 25 * phi_fad * trace(eps_fad);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;\endcode</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;Give some insight into the storage of the values and derivatives</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;\code</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;energy=&quot;</span> &lt;&lt; energy &lt;&lt; std::endl;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;\endcode</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;Compute sigma as \f[ \frac{\partial \Psi}{\partial \boldsymbol{\varepsilon}} \f]</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;\code</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;     SymmetricTensor&lt;2,dim&gt; sigma_Sac;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x=0; x&lt;6; ++x )</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;     {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=std_map_indicies[x].first;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=std_map_indicies[x].second;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">if</span> ( i!=j )</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            sigma_Sac[i][j] = 0.5 * energy.dx(x).val();</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            sigma_Sac[i][j] = energy.dx(x).val();</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;     }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;sigma_Sacado=&quot;</span> &lt;&lt; sigma_Sac &lt;&lt; std::endl;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     <span class="keywordtype">double</span> d_energy_d_phi = energy.dx(6).val();</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d_energy_d_phi=&quot;</span> &lt;&lt; d_energy_d_phi &lt;&lt; std::endl;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;\endcode</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;Analytical stress tensor:</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;\code</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;     SymmetricTensor&lt;2,dim&gt; sigma;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;     sigma = lambda*trace(eps)*unit_symmetric_tensor&lt;dim&gt;() + 2. * mu * eps;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;analy. sigma=&quot;</span> &lt;&lt; sigma &lt;&lt; std::endl;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;\endcode</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;Sacado-Tangent</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;\code</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;     SymmetricTensor&lt;4,dim&gt; C_Sac;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x=0;x&lt;6;++x)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> y=0;y&lt;6;++y)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=std_map_indicies[y].first;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=std_map_indicies[y].second;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=std_map_indicies[x].first;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l=std_map_indicies[x].second;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordtype">double</span> deriv = energy.dx(x).dx(y); <span class="comment">// Access the derivatives of the (i,j)-th component of \a sigma</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">if</span> ( k!=l &amp;&amp; i!=j )</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                C_Sac[i][j][k][l] = 0.25* deriv;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(k!=l)<span class="comment">/*Compare to Voigt notation since only SymmetricTensor instead of Tensor*/</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                C_Sac[i][j][k][l] = 0.5*deriv;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                C_Sac[i][j][l][k] = 0.5*deriv;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                C_Sac[i][j][k][l] = deriv;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;     <span class="keywordtype">double</span> d2_energy_d_phi_2 = energy.dx(6).dx(6);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d2_energy_d_phi_2=&quot;</span> &lt;&lt; d2_energy_d_phi_2 &lt;&lt; std::endl;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;     SymmetricTensor&lt;2,dim&gt; d2_energy_d_eps_d_phi;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;     SymmetricTensor&lt;2,dim, Sacado::Fad::DFad&lt;DFadType&gt; &gt; sigma_Sac_full;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x=0; x&lt;6; ++x )</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;     {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=std_map_indicies[x].first;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=std_map_indicies[x].second;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">if</span> ( i!=j )</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            sigma_Sac_full[i][j] = 0.5 * energy.dx(x);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            sigma_Sac_full[i][j] = energy.dx(x);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;     }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;sigma_Sac_full=&quot;</span> &lt;&lt; sigma_Sac_full &lt;&lt; std::endl;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;     d2_energy_d_eps_d_phi[0][0] = sigma_Sac_full[0][0].val().dx(6);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;     d2_energy_d_eps_d_phi[1][1] = sigma_Sac_full[1][1].val().dx(6);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;     d2_energy_d_eps_d_phi[2][2] = sigma_Sac_full[2][2].val().dx(6);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;     d2_energy_d_eps_d_phi[0][1] = sigma_Sac_full[0][1].val().dx(6);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;     d2_energy_d_eps_d_phi[0][2] = sigma_Sac_full[0][2].val().dx(6);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;     d2_energy_d_eps_d_phi[1][2] = sigma_Sac_full[1][2].val().dx(6);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d2_energy_d_eps_d_phi=&quot;</span> &lt;&lt; d2_energy_d_eps_d_phi &lt;&lt; std::endl;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;     SymmetricTensor&lt;2,dim&gt; d2_energy_d_phi_d_eps;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;     d2_energy_d_phi_d_eps[0][0] = energy.dx(6).dx(0);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;     d2_energy_d_phi_d_eps[0][1] = energy.dx(6).dx(1);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;     d2_energy_d_phi_d_eps[0][2] = energy.dx(6).dx(2);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;     d2_energy_d_phi_d_eps[1][1] = energy.dx(6).dx(3);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;     d2_energy_d_phi_d_eps[1][2] = energy.dx(6).dx(4);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;     d2_energy_d_phi_d_eps[2][2] = energy.dx(6).dx(5);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d2_energy_d_phi_d_eps=&quot;</span> &lt;&lt; d2_energy_d_phi_d_eps &lt;&lt; std::endl;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;\endcode</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;Analytical tangent</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;\code</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;     SymmetricTensor&lt;4,dim&gt; C_analy;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;     C_analy = lambda * outer_product(unit_symmetric_tensor&lt;dim&gt;(), unit_symmetric_tensor&lt;dim&gt;()) + 2. * mu * identity_tensor&lt;dim&gt;();</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordtype">double</span> error_Sacado_vs_analy=0;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dim; ++i)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dim; ++j)</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;dim; ++k)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l=0; l&lt;dim; ++l)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                    error_Sacado_vs_analy += std::fabs(C_Sac[i][j][k][l] - C_analy[i][j][k][l]);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Numerical error=&quot;</span> &lt;&lt; error_Sacado_vs_analy &lt;&lt; std::endl;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;}</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;\endcode</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;@section Ex8 8. Example: First and second derivatives - Using the Wrapper</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;\code</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keywordtype">void</span> <a class="code" href="Sacado__example_8cc.html#aa7108ff8393b98d66dfef50899d048d9">sacado_test_8</a> ()</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;{</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim=3;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test 8:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;\endcode</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;Defining the inputs (material parameters, strain tensor)</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;\code</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;     <span class="keywordtype">double</span> lambda=1;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;     <span class="keywordtype">double</span> mu=2;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;     SymmetricTensor&lt;2,dim, double&gt; eps;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;     <span class="keywordtype">double</span> phi = 0.3;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     eps[0][0] = 1.;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;     eps[1][1] = 2.;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;     eps[2][2] = 3.;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;     eps[0][1] = 4.;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;     eps[0][2] = 5.;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;     eps[1][2] = 6.;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;\endcode</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;Declaring the special data types containing all derivatives</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;\code</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;     <span class="keyword">typedef</span> Sacado::Fad::DFad&lt;double&gt; <a class="code" href="Sacado__Wrapper_8h.html#a7e0893207b87dad05c66a34baac8ed2e">DFadType</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;\endcode</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;Declare the variables \a eps_fad and \a phi_fad as the special Wrapper data types</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;\code</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;     <a class="code" href="classSacado__Wrapper_1_1SymTensor2.html">Sacado_Wrapper::SymTensor2&lt;dim&gt;</a> eps_fad;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;     <a class="code" href="classSacado__Wrapper_1_1SW__double2.html">Sacado_Wrapper::SW_double2&lt;dim&gt;</a> phi_fad;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;\endcode</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;Declare the summary data type relating all the dofs and initialising them too</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;\code</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;     <a class="code" href="classSacado__Wrapper_1_1DoFs__summary.html">Sacado_Wrapper::DoFs_summary&lt;dim&gt;</a> DoFs_summary;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;     DoFs_summary.<a class="code" href="classSacado__Wrapper_1_1DoFs__summary.html#ae273d0fa3197118a11d7005523e27d8a">init_set_dofs</a>(eps_fad, eps, phi_fad, phi);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;\endcode</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;The variables are outputted to give some insight into the storage of the values (derivatives still trivial).</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;\code</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;eps_fad=&quot;</span> &lt;&lt; eps_fad &lt;&lt; std::endl;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;phi_fad=&quot;</span> &lt;&lt; phi_fad &lt;&lt; std::endl;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;\endcode</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;Compute eps² = eps_ij * eps_jk in index notation</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;\code</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;     SymmetricTensor&lt;2,dim, Sacado::Fad::DFad&lt;DFadType&gt; &gt; eps_fad_squared;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;     <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dim; ++i)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;dim; ++k )</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dim; ++j )</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                <span class="keywordflow">if</span> ( i&gt;=k )</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    eps_fad_squared[i][k] += eps_fad[i][j] * eps_fad[j][k];</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;\endcode</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;Compute the strain energy density</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;\code</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;     Sacado::Fad::DFad&lt;DFadType&gt; energy;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;     energy = lambda/2. * trace(eps_fad)*trace(eps_fad) + mu * trace(eps_fad_squared) + 25 * phi_fad * trace(eps_fad);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;\endcode</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;The energy is outputted (formatted by hand) to give some insight into the storage of the values and derivatives. \n</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;energy=399 [ 17.5 32 40 21.5 48 25.5 150 ] \n</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                [ 17.5 [ 5 0 0 1 0 1 25 ] 32 [ 0 8 0 0 0 0 0 ] 40 [ 0 0 8 0 0 0 0 ] \n</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                21.5 [ 1 0 0 5 0 1 25 ] 48 [ 0 0 0 0 8 0 0 ] 25.5 [ 1 0 0 1 0 5 25 ] \n</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;\code</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">//              150 [ 25 0 0 25 0 25 0 ] ]</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;energy=&quot;</span> &lt;&lt; energy &lt;&lt; std::endl;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;\endcode</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;Compute sigma as \f[ \boldsymbol{\sigma} = \frac{\partial \Psi}{\partial \boldsymbol{\varepsilon}} \f]</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;\code</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;     SymmetricTensor&lt;2,dim&gt; sigma_Sac;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;     eps_fad.get_tangent(sigma_Sac, energy);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;sigma_Sacado=&quot;</span> &lt;&lt; sigma_Sac &lt;&lt; std::endl;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;     <span class="keywordtype">double</span> d_energy_d_phi;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;     phi_fad.<a class="code" href="classSacado__Wrapper_1_1SW__double2.html#ad51ba1e79171d60861b28098dfef903d">get_tangent</a>(d_energy_d_phi, energy);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d_energy_d_phi=&quot;</span> &lt;&lt; d_energy_d_phi &lt;&lt; std::endl;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;\endcode</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;Analytical stress tensor:</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;\code</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;     SymmetricTensor&lt;2,dim&gt; sigma;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;     sigma = lambda*trace(eps)*unit_symmetric_tensor&lt;dim&gt;() + 2. * mu * eps;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;analy. sigma=&quot;</span> &lt;&lt; sigma &lt;&lt; std::endl;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;\endcode</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;Sacado stress tangent (or eps curvature) as \f[ \frac{\partial^2 \Psi}{\partial \boldsymbol{\varepsilon}^2} \f]</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;\code</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;     SymmetricTensor&lt;4,dim&gt; C_Sac;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;     eps_fad.get_curvature(C_Sac, energy);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;\endcode</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;Sacado phi curvature as \f[ \frac{\partial^2 \Psi}{\partial \varphi^2} \f]</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;\code</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;     <span class="keywordtype">double</span> d2_energy_d_phi_2;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;     phi_fad.<a class="code" href="classSacado__Wrapper_1_1SW__double2.html#a7d3f3a21cd842645af9861bf50308825">get_curvature</a>(d2_energy_d_phi_2, energy);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d2_energy_d_phi_2=&quot;</span> &lt;&lt; d2_energy_d_phi_2 &lt;&lt; std::endl;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;\endcode</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;Sacado derivatives \f[ \frac{\partial^2 \Psi}{\partial \boldsymbol{\varepsilon} \partial \varphi} \f]</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;\code</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;     SymmetricTensor&lt;2,dim&gt; d2_energy_d_eps_d_phi;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;     DoFs_summary.get_curvature(d2_energy_d_eps_d_phi, energy, eps_fad, phi_fad);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d2_energy_d_eps_d_phi=&quot;</span> &lt;&lt; d2_energy_d_eps_d_phi &lt;&lt; std::endl;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;\endcode</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;Sacado derivatives \f[ \frac{\partial^2 \Psi}{\partial \varphi \partial \boldsymbol{\varepsilon}} \f]</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;\code</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;     SymmetricTensor&lt;2,dim&gt; d2_energy_d_phi_d_eps;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;     DoFs_summary.get_curvature(d2_energy_d_phi_d_eps, energy, phi_fad, eps_fad);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;d2_energy_d_phi_d_eps=&quot;</span> &lt;&lt; d2_energy_d_phi_d_eps &lt;&lt; std::endl;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;\endcode</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;When you consider the output: \n</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;d2_energy_d_eps_d_phi=25 0 0 0 25 0 0 0 25 \n</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;d2_energy_d_phi_d_eps=25 0 0 0 25 0 0 0 25 \n</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;in detail you will notice that both second derivatives are identical. This compplies with the Schwarz integrability condition (Symmetry of second derivatives)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;(ignoring all limitation and requirements), it holds</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;\f[ \frac{\partial^2 \Psi}{\partial \boldsymbol{\varepsilon} \partial \varphi} = \frac{\partial^2 \Psi}{\partial \varphi \partial \boldsymbol{\varepsilon}}  \f]</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;Analytical stress tangent</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;\code</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;     SymmetricTensor&lt;4,dim&gt; C_analy;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;     C_analy = lambda * outer_product(unit_symmetric_tensor&lt;dim&gt;(), unit_symmetric_tensor&lt;dim&gt;()) + 2. * mu * identity_tensor&lt;dim&gt;();</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;\endcode</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;Compute the error <span class="keywordflow">for</span> the stress tangent</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;\code</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;     <span class="keywordtype">double</span> error_Sacado_vs_analy=0;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dim; ++i)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;dim; ++j)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;dim; ++k)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l=0; l&lt;dim; ++l)</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    error_Sacado_vs_analy += std::fabs(C_Sac[i][j][k][l] - C_analy[i][j][k][l]);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Numerical error=&quot;</span> &lt;&lt; error_Sacado_vs_analy &lt;&lt; std::endl;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment"> * The main function just calls all the examples and puts some space between the outputs.</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="keywordtype">int</span> <a class="code" href="Sacado__example_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;{</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a71b2675e62203edc430e7ffc8a365193">sacado_test_scalar</a> ();</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a8ef4ff1e9526ca8451cdcd1678366d2c">sacado_test_2</a> ();</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="Sacado__example_8cc.html#ae45e1df0eec246dbb6f2c3d28a2a58e4">sacado_test_3</a> ();</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <a class="code" href="Sacado__example_8cc.html#ae63cc8526935cb0512668e83cfc7b929">sacado_test_3B</a> ();</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a2f4def4563e31d720e07bc7d6363ebe2">sacado_test_4</a>();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a327dbbb4ea7fc9840c46d149843a44c2">sacado_test_5</a>();</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a27450ab52a9d4250e3f5a5f2a3f8f317">sacado_test_6</a>();</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="Sacado__example_8cc.html#a0b694459e5e15c1578d97e637faba8de">sacado_test_7</a>();</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="Sacado__example_8cc.html#aa7108ff8393b98d66dfef50899d048d9">sacado_test_8</a>();</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;}</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;\endcode</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;@section END The End</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;Hosted via GitHub according to https:<span class="comment">//goseeky.wordpress.com/2017/07/22/documentation-101-doxygen-with-github-pages/</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;@}</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;*/</div><div class="ttc" id="Sacado__example_8cc_html_a327dbbb4ea7fc9840c46d149843a44c2"><div class="ttname"><a href="Sacado__example_8cc.html#a327dbbb4ea7fc9840c46d149843a44c2">sacado_test_5</a></div><div class="ttdeci">void sacado_test_5()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:530</div></div>
<div class="ttc" id="Sacado__example_8cc_html_a71b2675e62203edc430e7ffc8a365193"><div class="ttname"><a href="Sacado__example_8cc.html#a71b2675e62203edc430e7ffc8a365193">sacado_test_scalar</a></div><div class="ttdeci">void sacado_test_scalar()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:38</div></div>
<div class="ttc" id="Sacado__example_8cc_html_a27450ab52a9d4250e3f5a5f2a3f8f317"><div class="ttname"><a href="Sacado__example_8cc.html#a27450ab52a9d4250e3f5a5f2a3f8f317">sacado_test_6</a></div><div class="ttdeci">void sacado_test_6()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:563</div></div>
<div class="ttc" id="Sacado__Wrapper_8h_html_a7e0893207b87dad05c66a34baac8ed2e"><div class="ttname"><a href="Sacado__Wrapper_8h.html#a7e0893207b87dad05c66a34baac8ed2e">DFadType</a></div><div class="ttdeci">Sacado::Fad::DFad&lt; double &gt; DFadType</div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:17</div></div>
<div class="ttc" id="Sacado__example_8cc_html_aa7108ff8393b98d66dfef50899d048d9"><div class="ttname"><a href="Sacado__example_8cc.html#aa7108ff8393b98d66dfef50899d048d9">sacado_test_8</a></div><div class="ttdeci">void sacado_test_8()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:798</div></div>
<div class="ttc" id="Sacado__example_8cc_html_a2f4def4563e31d720e07bc7d6363ebe2"><div class="ttname"><a href="Sacado__example_8cc.html#a2f4def4563e31d720e07bc7d6363ebe2">sacado_test_4</a></div><div class="ttdeci">void sacado_test_4()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:418</div></div>
<div class="ttc" id="Sacado__example_8cc_html_a8ef4ff1e9526ca8451cdcd1678366d2c"><div class="ttname"><a href="Sacado__example_8cc.html#a8ef4ff1e9526ca8451cdcd1678366d2c">sacado_test_2</a></div><div class="ttdeci">void sacado_test_2()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:66</div></div>
<div class="ttc" id="classSacado__Wrapper_1_1SW__double2_html"><div class="ttname"><a href="classSacado__Wrapper_1_1SW__double2.html">Sacado_Wrapper::SW_double2</a></div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:359</div></div>
<div class="ttc" id="classSacado__Wrapper_1_1SW__double2_html_a7d3f3a21cd842645af9861bf50308825"><div class="ttname"><a href="classSacado__Wrapper_1_1SW__double2.html#a7d3f3a21cd842645af9861bf50308825">Sacado_Wrapper::SW_double2::get_curvature</a></div><div class="ttdeci">void get_curvature(double &amp;Curvature, Sacado::Fad::DFad&lt; DFadType &gt; &amp;argument)</div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:407</div></div>
<div class="ttc" id="CMakeCache_8txt_html_aac1d6a1710812201527c735f7c6afbaa"><div class="ttname"><a href="CMakeCache_8txt.html#aac1d6a1710812201527c735f7c6afbaa">c</a></div><div class="ttdeci">usr include c</div><div class="ttdef"><b>Definition:</b> CMakeCache.txt:320</div></div>
<div class="ttc" id="classSacado__Wrapper_1_1DoFs__summary_html"><div class="ttname"><a href="classSacado__Wrapper_1_1DoFs__summary.html">Sacado_Wrapper::DoFs_summary</a></div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:450</div></div>
<div class="ttc" id="Sacado__example_8cc_html_a868b94676739e612d9c95940e70892a9"><div class="ttname"><a href="Sacado__example_8cc.html#a868b94676739e612d9c95940e70892a9">fad_double</a></div><div class="ttdeci">Sacado::Fad::DFad&lt; double &gt; fad_double</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:31</div></div>
<div class="ttc" id="Sacado__Wrapper_8h_html"><div class="ttname"><a href="Sacado__Wrapper_8h.html">Sacado_Wrapper.h</a></div></div>
<div class="ttc" id="Sacado__example_8cc_html_ae45e1df0eec246dbb6f2c3d28a2a58e4"><div class="ttname"><a href="Sacado__example_8cc.html#ae45e1df0eec246dbb6f2c3d28a2a58e4">sacado_test_3</a></div><div class="ttdeci">void sacado_test_3()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:131</div></div>
<div class="ttc" id="Sacado__example_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="Sacado__example_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:915</div></div>
<div class="ttc" id="Sacado__example_8cc_html_ae63cc8526935cb0512668e83cfc7b929"><div class="ttname"><a href="Sacado__example_8cc.html#ae63cc8526935cb0512668e83cfc7b929">sacado_test_3B</a></div><div class="ttdeci">void sacado_test_3B()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:356</div></div>
<div class="ttc" id="classSacado__Wrapper_1_1SW__double2_html_ad51ba1e79171d60861b28098dfef903d"><div class="ttname"><a href="classSacado__Wrapper_1_1SW__double2.html#ad51ba1e79171d60861b28098dfef903d">Sacado_Wrapper::SW_double2::get_tangent</a></div><div class="ttdeci">void get_tangent(double &amp;Tangent, Sacado::Fad::DFad&lt; DFadType &gt; &amp;argument)</div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:400</div></div>
<div class="ttc" id="classSacado__Wrapper_1_1SymTensor2_html"><div class="ttname"><a href="classSacado__Wrapper_1_1SymTensor2.html">Sacado_Wrapper::SymTensor2</a></div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:176</div></div>
<div class="ttc" id="Sacado__example_8cc_html_a0b694459e5e15c1578d97e637faba8de"><div class="ttname"><a href="Sacado__example_8cc.html#a0b694459e5e15c1578d97e637faba8de">sacado_test_7</a></div><div class="ttdeci">void sacado_test_7()</div><div class="ttdef"><b>Definition:</b> Sacado_example.cc:617</div></div>
<div class="ttc" id="classSacado__Wrapper_1_1DoFs__summary_html_ae273d0fa3197118a11d7005523e27d8a"><div class="ttname"><a href="classSacado__Wrapper_1_1DoFs__summary.html#ae273d0fa3197118a11d7005523e27d8a">Sacado_Wrapper::DoFs_summary::init_set_dofs</a></div><div class="ttdeci">void init_set_dofs(SymTensor2&lt; dim &gt; &amp;eps, SymmetricTensor&lt; 2, dim &gt; &amp;eps_init, SW_double2&lt; dim &gt; &amp;double_arg, double &amp;double_init)</div><div class="ttdef"><b>Definition:</b> Sacado_Wrapper.h:477</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
